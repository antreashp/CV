%% Load imagesimage1_sp = im2double(imread('images/image1_saltpepper.jpg'));image1_gaussian = im2double(imread('images/image1_gaussian.jpg'));image1 = im2double(imread('images/image1.jpg'));% output PSNRmyPSNR(image1, image1_sp)myPSNR(image1, image1_gaussian)% denoise in multiple wayssp_boxed = denoise(image1_sp, 'box');sp_median = denoise(image1_sp, 'median');sp_gaussian = denoise(image1_sp, 'gaussian', 2, 5);% make the denoised ones for both the saltpepper and gaussiansdenoised_sp_box = cat(3, denoise(image1_sp, 'box', 3), denoise(image1_sp, 'box', 5), denoise(image1_sp, 'box', 7));denoised_sp_median = cat(3, denoise(image1_sp, 'median', [3 3]), denoise(image1_sp, 'median', [5 5]), denoise(image1_sp, 'median', [7 7]));denoised_gauss_box = cat(3, denoise(image1_gaussian, 'box', 3), denoise(image1_gaussian, 'box', 5), denoise(image1_gaussian, 'box', 7));denoised_gauss_median = cat(3, denoise(image1_gaussian, 'median', [3 3]), denoise(image1_gaussian, 'median', [5 5]), denoise(image1_gaussian, 'median', [7 7]));% make the figure for the salt-pepperfigure;subplot(2, 3, 1); imshow(denoised_sp_box(:,:,1)); title('Box 3x3'); subplot(2, 3, 2); imshow(denoised_sp_box(:,:,2)); title('Box 5x5'); subplot(2, 3, 3); imshow(denoised_sp_box(:,:,3)); title('Box 7x7');subplot(2, 3, 4); imshow(denoised_sp_median(:,:,1)); title('Median 3x3');subplot(2, 3, 5); imshow(denoised_sp_median(:,:,2)); title('Median 5x5');subplot(2, 3, 6); imshow(denoised_sp_median(:,:,3)); title('Median 7x7');saveas(gca, 'plots/salt-pepper-noise.png');% make the figure for the gaussian noisefigure;subplot(2, 3, 1); imshow(denoised_gauss_box(:,:,1)); title('Box 3x3'); subplot(2, 3, 2); imshow(denoised_gauss_box(:,:,2)); title('Box 5x5'); subplot(2, 3, 3); imshow(denoised_gauss_box(:,:,3)); title('Box 7x7');subplot(2, 3, 4); imshow(denoised_gauss_median(:,:,1)); title('Median 3x3');subplot(2, 3, 5); imshow(denoised_gauss_median(:,:,2)); title('Median 5x5');subplot(2, 3, 6); imshow(denoised_gauss_median(:,:,3)); title('Median 7x7');saveas(gca, 'plots/gaussian-noise.png');% generate all psnr values for salt and pepperPSNRs_sp_box = arrayfun(@(i) myPSNR(image1, denoised_sp_box(:,:,i)), 1:3);PSNRs_sp_median = arrayfun(@(i) myPSNR(image1, denoised_sp_median(:,:,i)), 1:3);PSNRs_gauss_box = arrayfun(@(i) myPSNR(image1, denoised_gauss_box(:,:,i)), 1:3);PSNRs_gauss_median = arrayfun(@(i) myPSNR(image1, denoised_gauss_median(:,:,i)), 1:3);% denoise gaussian using gaussian filtering (chosen window = 5)denoised_gauss = cat(3, denoise(image1, 'gaussian', 0.5, 5), denoise(image1_gaussian, 'gaussian', 1, 5), denoise(image1_gaussian, 'gaussian', 2, 5));PSNRs_gauss_filter = arrayfun(@(i) myPSNR(image1, denoised_gauss(:,:,i)), 1:3);% tablesPSNRs_sp = [PSNRs_sp_box; PSNRs_sp_median]PSNRs_gauss = [PSNRs_gauss_box; PSNRs_gauss_median; PSNRs_gauss_filter]% make the figure for the gaussian filteringfigure;subplot(1, 3, 1); imshow(denoised_gauss(:,:,1)); title('Sigma = 0.5'); subplot(1, 3, 2); imshow(denoised_gauss(:,:,2)); title('Sigma = 1'); subplot(1, 3, 3); imshow(denoised_gauss(:,:,3)); title('Sigma = 2');saveas(gcf, 'plots/gaussian-filtered.png');